{% extends "base.html" %}

{% load crispy_forms_tags  %}

{% block title %}{{ product.name }}{% endblock title %}
{% block js %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>
{% endblock js %}
{% block content %}
<div class="container">
    <div class="row align-items-start">
        <div class="col">
            {% if not product.all_photos %}
            <a href="{{ product.image.url }}" class="img-thumbnail" data-lightbox="product-images">
                <img src="{{ product.image.url }}" class="img-thumbnail">
            </a>
            {% else %}
            {% for photo in product.all_photos %}
            <a href="{{ photo.photo.url }}" class="img-thumbnail" data-lightbox="product-images">
                <img src="{{ photo.photo.url }}" alt="{{ product.name }}" class="img-thumbnail">
            </a>
            {% endfor %}
            {% endif %}
        </div>
        <div class="col">
            <p><strong>{{ product.name }}</strong></p>
            <div class="col">
                <pre>{{ product.description_all }}</pre>
            </div>
        </div>

        <div class="col">
            <p><strong>{{ "Цена:" }} {{ product.price }} {{ "руб." }}</strong></p>
            <div class="btn btn-dark nav-item me-2">
                <a class="nav-link" href="{% url 'add_to_cart' product.id %}">Добавить в корзину</a>
            </div>
        </div>
    </div>
    <hr>
    <h6>Отзывы</h6>
    <hr>
    {% if user.is_authenticated %}
    <h5>Добавить отзыв</h5>
    <form action="" method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <button class="btn btn-dark ml-2" type="submit">Оставить отзыв</button>
    </form>
    {% endif %}
    <hr>
    {% for comment in product.comment_set.all %}
    <p><strong>{{ comment.author }}</strong></p>
    <p>{{ comment }}</p>
    {% endfor %}
    <hr>
</div>
<script>$(document).ready(function () {
  lightbox.option({
    'resizeDuration': 200,
    'wrapAround': true
  })
})


</script>
{% endblock content %}